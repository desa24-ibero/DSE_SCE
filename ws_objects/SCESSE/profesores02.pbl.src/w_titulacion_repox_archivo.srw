$PBExportHeader$w_titulacion_repox_archivo.srw
forward
global type w_titulacion_repox_archivo from Window
end type
type tab_1 from tab within w_titulacion_repox_archivo
end type
type tabpage_general from userobject within tab_1
end type
type dw_3 from datawindow within tabpage_general
end type
type uo_nivel from uo_mostrar_grado within tabpage_general
end type
type rb_1 from radiobutton within tabpage_general
end type
type rb_2 from radiobutton within tabpage_general
end type
type rb_3 from radiobutton within tabpage_general
end type
type vsb_dw_certificado from vscrollbar within tabpage_general
end type
type cb_1 from commandbutton within tabpage_general
end type
type em_2 from editmask within tabpage_general
end type
type em_1 from editmask within tabpage_general
end type
type cb_3 from commandbutton within tabpage_general
end type
type cbx_1 from checkbox within tabpage_general
end type
type cbx_2 from checkbox within tabpage_general
end type
type st_1 from statictext within tabpage_general
end type
type gb_3 from groupbox within tabpage_general
end type
type gb_1 from groupbox within tabpage_general
end type
type gb_4 from groupbox within tabpage_general
end type
type gb_6 from groupbox within tabpage_general
end type
type gb_8 from groupbox within tabpage_general
end type
type vsb_dw_certificado2 from vscrollbar within tabpage_general
end type
type dw_2 from datawindow within tabpage_general
end type
type gb_2 from groupbox within tabpage_general
end type
type gb_7 from groupbox within tabpage_general
end type
type gb_5 from groupbox within tabpage_general
end type
type dw_1 from datawindow within tabpage_general
end type
type tabpage_individual from userobject within tab_1
end type
type uo_nivel_2 from uo_mostrar_grado within tabpage_individual
end type
type lb_1 from listbox within tabpage_individual
end type
type dw_2x from datawindow within tabpage_individual
end type
type cb_5x from commandbutton within tabpage_individual
end type
type rb_3x from radiobutton within tabpage_individual
end type
type rb_2x from radiobutton within tabpage_individual
end type
type rb_1x from radiobutton within tabpage_individual
end type
type cbx_2x from checkbox within tabpage_individual
end type
type st_1x from statictext within tabpage_individual
end type
type em_1x from editmask within tabpage_individual
end type
type cb_3x from commandbutton within tabpage_individual
end type
type gb_8x from groupbox within tabpage_individual
end type
type gb_7x from groupbox within tabpage_individual
end type
type gb_2x from groupbox within tabpage_individual
end type
type cb_4x from commandbutton within tabpage_individual
end type
type cb_1x from commandbutton within tabpage_individual
end type
type gb_3x from groupbox within tabpage_individual
end type
type gb_4x from groupbox within tabpage_individual
end type
type cb_2x from commandbutton within tabpage_individual
end type
type gb_5x from groupbox within tabpage_individual
end type
type gb_6x from groupbox within tabpage_individual
end type
type vsb_dw_certificadox from vscrollbar within tabpage_individual
end type
type gb_1x from groupbox within tabpage_individual
end type
type lb_2 from listbox within tabpage_individual
end type
type dw_1x from datawindow within tabpage_individual
end type
type tabpage_opcion from userobject within tab_1
end type
type uo_nivel_3 from uo_mostrar_grado within tabpage_opcion
end type
type dw_3w from datawindow within tabpage_opcion
end type
type rb_1w from radiobutton within tabpage_opcion
end type
type rb_2w from radiobutton within tabpage_opcion
end type
type rb_3w from radiobutton within tabpage_opcion
end type
type vsb_dw_certificadow from vscrollbar within tabpage_opcion
end type
type cb_1w from commandbutton within tabpage_opcion
end type
type em_2w from editmask within tabpage_opcion
end type
type em_1w from editmask within tabpage_opcion
end type
type cb_3w from commandbutton within tabpage_opcion
end type
type cbx_1w from checkbox within tabpage_opcion
end type
type cbx_2w from checkbox within tabpage_opcion
end type
type st_1w from statictext within tabpage_opcion
end type
type gb_3w from groupbox within tabpage_opcion
end type
type gb_4w from groupbox within tabpage_opcion
end type
type gb_6w from groupbox within tabpage_opcion
end type
type gb_8w from groupbox within tabpage_opcion
end type
type gb_1w from groupbox within tabpage_opcion
end type
type vsb_dw_certificado2w from vscrollbar within tabpage_opcion
end type
type dw_2w from datawindow within tabpage_opcion
end type
type gb_2w from groupbox within tabpage_opcion
end type
type vsb_dw_certificado3 from vscrollbar within tabpage_opcion
end type
type gb_9w from groupbox within tabpage_opcion
end type
type gb_7w from groupbox within tabpage_opcion
end type
type gb_5w from groupbox within tabpage_opcion
end type
type dw_4w from datawindow within tabpage_opcion
end type
type dw_1w from datawindow within tabpage_opcion
end type
type tabpage_general from userobject within tab_1
dw_3 dw_3
uo_nivel uo_nivel
rb_1 rb_1
rb_2 rb_2
rb_3 rb_3
vsb_dw_certificado vsb_dw_certificado
cb_1 cb_1
em_2 em_2
em_1 em_1
cb_3 cb_3
cbx_1 cbx_1
cbx_2 cbx_2
st_1 st_1
gb_3 gb_3
gb_1 gb_1
gb_4 gb_4
gb_6 gb_6
gb_8 gb_8
vsb_dw_certificado2 vsb_dw_certificado2
dw_2 dw_2
gb_2 gb_2
gb_7 gb_7
gb_5 gb_5
dw_1 dw_1
end type
type tabpage_individual from userobject within tab_1
uo_nivel_2 uo_nivel_2
lb_1 lb_1
dw_2x dw_2x
cb_5x cb_5x
rb_3x rb_3x
rb_2x rb_2x
rb_1x rb_1x
cbx_2x cbx_2x
st_1x st_1x
em_1x em_1x
cb_3x cb_3x
gb_8x gb_8x
gb_7x gb_7x
gb_2x gb_2x
cb_4x cb_4x
cb_1x cb_1x
gb_3x gb_3x
gb_4x gb_4x
cb_2x cb_2x
gb_5x gb_5x
gb_6x gb_6x
vsb_dw_certificadox vsb_dw_certificadox
gb_1x gb_1x
lb_2 lb_2
dw_1x dw_1x
end type
type tabpage_opcion from userobject within tab_1
uo_nivel_3 uo_nivel_3
dw_3w dw_3w
rb_1w rb_1w
rb_2w rb_2w
rb_3w rb_3w
vsb_dw_certificadow vsb_dw_certificadow
cb_1w cb_1w
em_2w em_2w
em_1w em_1w
cb_3w cb_3w
cbx_1w cbx_1w
cbx_2w cbx_2w
st_1w st_1w
gb_3w gb_3w
gb_4w gb_4w
gb_6w gb_6w
gb_8w gb_8w
gb_1w gb_1w
vsb_dw_certificado2w vsb_dw_certificado2w
dw_2w dw_2w
gb_2w gb_2w
vsb_dw_certificado3 vsb_dw_certificado3
gb_9w gb_9w
gb_7w gb_7w
gb_5w gb_5w
dw_4w dw_4w
dw_1w dw_1w
end type
type tab_1 from tab within w_titulacion_repox_archivo
tabpage_general tabpage_general
tabpage_individual tabpage_individual
tabpage_opcion tabpage_opcion
end type
end forward

global type w_titulacion_repox_archivo from Window
int X=834
int Y=362
int Width=3657
int Height=1981
boolean TitleBar=true
string Title="Reportes de Alumnos Titulados para Archivo"
string MenuName="m_titulacion2"
boolean ControlMenu=true
boolean MinBox=true
boolean MaxBox=true
boolean Resizable=true
tab_1 tab_1
end type
global w_titulacion_repox_archivo w_titulacion_repox_archivo

type variables
int carrerax
int carrera2
long opcion
end variables

forward prototypes
public function string wf_obten_nivel ()
end prototypes

public function string wf_obten_nivel ();string ls_nivel
//w_titulacion_repox ventana

//ventana = this
//SetNull(ls_nivel)
//
//if ventana.uo_nivel.Checked= true  then
//	
//end if
//
return ls_nivel
end function

on w_titulacion_repox_archivo.create
if this.MenuName = "m_titulacion2" then this.MenuID = create m_titulacion2
this.tab_1=create tab_1
this.Control[]={this.tab_1}
end on

on w_titulacion_repox_archivo.destroy
if IsValid(MenuID) then destroy(MenuID)
destroy(this.tab_1)
end on

event open;/*Cuando se abra la ventana w_certificados...*/
int li_selectedrowcount
/*Haz que la fuente de datos de el DataWindow sea el gtr_sce*/
tab_1.tabpage_general.dw_1.settransobject(gtr_sce)
tab_1.tabpage_general.dw_2.settransobject(gtr_sce)
tab_1.tabpage_general.dw_3.settransobject(gtr_sce)

tab_1.tabpage_individual.dw_1x.settransobject(gtr_sce)
tab_1.tabpage_individual.dw_2x.settransobject(gtr_sce)

tab_1.tabpage_opcion.dw_1w.settransobject(gtr_sce)
tab_1.tabpage_opcion.dw_2w.settransobject(gtr_sce)
tab_1.tabpage_opcion.dw_3w.settransobject(gtr_sce)
tab_1.tabpage_opcion.dw_4w.settransobject(gtr_sce)

/*Acomoda la ventana en el margen superior izquierdo*/
this.x=1
this.y=1

/*Desabilita las opciones nuevo, actualiza y borra del menú*/
m_titulacion2.m_registro.m_nuevo.disable( )
m_titulacion2.m_registro.m_actualiza.disable( )
m_titulacion2.m_registro.m_borraregistro.disable( )

//li_selectedrowcount = tab_1.tabpage_individual.lb_1.Event pfc_InvertSelection()
end event

type tab_1 from tab within w_titulacion_repox_archivo
int X=22
int Y=26
int Width=3672
int Height=1786
int TabOrder=100
boolean FixedWidth=true
boolean RaggedRight=true
boolean BoldSelectedText=true
Alignment Alignment=Center!
int SelectedTab=1
TabPosition TabPosition=TabsOnLeft!
long BackColor=0
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
tabpage_general tabpage_general
tabpage_individual tabpage_individual
tabpage_opcion tabpage_opcion
end type

on tab_1.create
this.tabpage_general=create tabpage_general
this.tabpage_individual=create tabpage_individual
this.tabpage_opcion=create tabpage_opcion
this.Control[]={this.tabpage_general,&
this.tabpage_individual,&
this.tabpage_opcion}
end on

on tab_1.destroy
destroy(this.tabpage_general)
destroy(this.tabpage_individual)
destroy(this.tabpage_opcion)
end on

event selectionchanged;/* Se asignan los datawindows dependiendo del TAB al menu, para poder imprimirlos */
if newindex = 1 then
	 m_titulacion2.dw = tab_1.tabpage_general.dw_1
    m_titulacion2.dw2 = tab_1.tabpage_general.dw_3
	 tab_1.tabpage_general.gb_1.taborder =0
	 tab_1.tabpage_general.gb_2.taborder =0
	 tab_1.tabpage_general.gb_3.taborder =0
	 tab_1.tabpage_general.gb_4.taborder =0
	 tab_1.tabpage_general.gb_5.taborder =0
	 tab_1.tabpage_general.gb_6.taborder =0
	 tab_1.tabpage_general.gb_7.taborder =0
	 tab_1.tabpage_general.gb_8.taborder =0
end if
if newindex = 2 then
	 m_titulacion2.dw = tab_1.tabpage_individual.dw_1x
    m_titulacion2.dw2 = tab_1.tabpage_individual.dw_2x

	 tab_1.tabpage_individual.gb_1x.taborder=0
 	 tab_1.tabpage_individual.gb_2x.taborder=0
  	 tab_1.tabpage_individual.gb_3x.taborder=0
	 tab_1.tabpage_individual.gb_4x.taborder=0
	 tab_1.tabpage_individual.gb_5x.taborder=0
	 tab_1.tabpage_individual.gb_6x.taborder=0
	 tab_1.tabpage_individual.gb_7x.taborder=0
	 tab_1.tabpage_individual.gb_8x.taborder=0

end if
if newindex = 3 then
	 m_titulacion2.dw = tab_1.tabpage_opcion.dw_1w
    m_titulacion2.dw2 = tab_1.tabpage_opcion.dw_3w

	 tab_1.tabpage_opcion.gb_1w.taborder=0
 	 tab_1.tabpage_opcion.gb_2w.taborder=0
  	 tab_1.tabpage_opcion.gb_3w.taborder=0
	 tab_1.tabpage_opcion.gb_4w.taborder=0
	 tab_1.tabpage_opcion.gb_5w.taborder=0
	 tab_1.tabpage_opcion.gb_6w.taborder=0
	 tab_1.tabpage_opcion.gb_7w.taborder=0
	 tab_1.tabpage_opcion.gb_8w.taborder=0
    tab_1.tabpage_opcion.gb_9w.taborder=0
end if


end event

type tabpage_general from userobject within tab_1
event create ( )
event destroy ( )
int X=113
int Y=13
int Width=3544
int Height=1760
long BackColor=16777215
string Text="General"
long TabBackColor=15780518
long TabTextColor=33554432
long PictureMaskColor=553648127
string PictureName="Custom045!"
dw_3 dw_3
uo_nivel uo_nivel
rb_1 rb_1
rb_2 rb_2
rb_3 rb_3
vsb_dw_certificado vsb_dw_certificado
cb_1 cb_1
em_2 em_2
em_1 em_1
cb_3 cb_3
cbx_1 cbx_1
cbx_2 cbx_2
st_1 st_1
gb_3 gb_3
gb_1 gb_1
gb_4 gb_4
gb_6 gb_6
gb_8 gb_8
vsb_dw_certificado2 vsb_dw_certificado2
dw_2 dw_2
gb_2 gb_2
gb_7 gb_7
gb_5 gb_5
dw_1 dw_1
end type

on tabpage_general.create
this.dw_3=create dw_3
this.uo_nivel=create uo_nivel
this.rb_1=create rb_1
this.rb_2=create rb_2
this.rb_3=create rb_3
this.vsb_dw_certificado=create vsb_dw_certificado
this.cb_1=create cb_1
this.em_2=create em_2
this.em_1=create em_1
this.cb_3=create cb_3
this.cbx_1=create cbx_1
this.cbx_2=create cbx_2
this.st_1=create st_1
this.gb_3=create gb_3
this.gb_1=create gb_1
this.gb_4=create gb_4
this.gb_6=create gb_6
this.gb_8=create gb_8
this.vsb_dw_certificado2=create vsb_dw_certificado2
this.dw_2=create dw_2
this.gb_2=create gb_2
this.gb_7=create gb_7
this.gb_5=create gb_5
this.dw_1=create dw_1
this.Control[]={this.dw_3,&
this.uo_nivel,&
this.rb_1,&
this.rb_2,&
this.rb_3,&
this.vsb_dw_certificado,&
this.cb_1,&
this.em_2,&
this.em_1,&
this.cb_3,&
this.cbx_1,&
this.cbx_2,&
this.st_1,&
this.gb_3,&
this.gb_1,&
this.gb_4,&
this.gb_6,&
this.gb_8,&
this.vsb_dw_certificado2,&
this.dw_2,&
this.gb_2,&
this.gb_7,&
this.gb_5,&
this.dw_1}
end on

on tabpage_general.destroy
destroy(this.dw_3)
destroy(this.uo_nivel)
destroy(this.rb_1)
destroy(this.rb_2)
destroy(this.rb_3)
destroy(this.vsb_dw_certificado)
destroy(this.cb_1)
destroy(this.em_2)
destroy(this.em_1)
destroy(this.cb_3)
destroy(this.cbx_1)
destroy(this.cbx_2)
destroy(this.st_1)
destroy(this.gb_3)
destroy(this.gb_1)
destroy(this.gb_4)
destroy(this.gb_6)
destroy(this.gb_8)
destroy(this.vsb_dw_certificado2)
destroy(this.dw_2)
destroy(this.gb_2)
destroy(this.gb_7)
destroy(this.gb_5)
destroy(this.dw_1)
end on

type dw_3 from datawindow within tabpage_general
event constructor pbm_constructor
int X=7
int Y=1901
int Width=3493
int Height=362
int TabOrder=5
string DataObject="dw_tit_cuenta_arch"
boolean LiveScroll=true
end type

event constructor;settransobject(gtr_sce)
//m_titulacion2.dw2 = this
TabOrder = 0
end event

type uo_nivel from uo_mostrar_grado within tabpage_general
int X=965
int Y=67
int TabOrder=13
boolean Border=false
BorderStyle BorderStyle=StyleBox!
end type

on uo_nivel.destroy
call uo_mostrar_grado::destroy
end on

type rb_1 from radiobutton within tabpage_general
int X=1532
int Y=259
int Width=344
int Height=77
string Text="Alfabetico"
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type rb_2 from radiobutton within tabpage_general
int X=1902
int Y=269
int Width=282
int Height=67
string Text="Cuenta"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type rb_3 from radiobutton within tabpage_general
int X=2235
int Y=259
int Width=252
int Height=77
string Text="Fecha"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type vsb_dw_certificado from vscrollbar within tabpage_general
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=3072
int Y=400
int Width=201
int Height=157
boolean Enabled=false
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_1.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */
dw_1.ScrollToRow(scrollpos)

if dw_1.Rowcount()=0 then
	st_1.text='Actual : 0 / 0'	
else
   st_1.text='Actual : '+string(scrollpos)+' / '+string(dw_1.RowCount())	
end if

end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type cb_1 from commandbutton within tabpage_general
event clicked pbm_bnclicked
int X=3039
int Y=205
int Width=263
int Height=109
int TabOrder=4
string Text="Cargar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;string ls_nivel
SetNull(ls_nivel)

if uo_nivel.rb_licenciatura.Checked then
	ls_nivel = "L"
elseif uo_nivel.rb_posgrado.Checked then
	ls_nivel = "P"
elseif uo_nivel.rb_todos.Checked then
	ls_nivel = "X"
end if

/*Se validan las fechas, y si son validas se mandan al datawindow */
if isdate(em_1.text) and isdate(em_2.text) then
	if date(em_2.text)>=date(em_1.text) then
			if (carrerax = 999) then
				carrerax=0
			end if	
			dw_1.retrieve(date(em_1.text),date(em_2.text),carrerax, ls_nivel)
			dw_3.retrieve(date(em_1.text),date(em_2.text),carrerax, ls_nivel)
/* Se ordenan al terminar de traer los datos */
			cb_3.triggerevent("clicked") 
	else
		messagebox(" Error ","Las fechas poseen un formato invalido, posiblemente la fecha inicial sea mayor a la fecha final",StopSign!)
	end if	
else	
     messagebox("Error","Las fechas poseen un formato invalido, favor de revisar",StopSign!)
end if
end event

event constructor;TabOrder = 3
end event

type em_2 from editmask within tabpage_general
int X=549
int Y=144
int Width=362
int Height=83
int TabOrder=4
Alignment Alignment=Center!
BorderStyle BorderStyle=StyleLowered!
string Mask="dd/mm/yyyy"
MaskDataType MaskDataType=DateMask!
string DisplayData=""
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 2
end event

type em_1 from editmask within tabpage_general
event constructor pbm_constructor
int X=80
int Y=144
int Width=362
int Height=83
int TabOrder=3
Alignment Alignment=Center!
BorderStyle BorderStyle=StyleLowered!
string Mask="dd/mm/yyyy"
MaskDataType MaskDataType=DateMask!
string DisplayData=""
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 1
end event

type cb_3 from commandbutton within tabpage_general
event clicked pbm_bnclicked
int X=2597
int Y=112
int Width=263
int Height=90
int TabOrder=4
string Text="Ordenar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se verifica que opcion de Ordenamiento se requiere por medio de los checks*/

if (rb_1.checked=TRUE) then
   dw_1.setsort("alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A, carreras_carrera A")
	dw_1.sort()
   if (cbx_2.checked=TRUE) then
      dw_1.setsort("carreras_carrera A, alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A")
		dw_1.sort()
	end if	
end if

if (rb_2.checked=TRUE) then
   dw_1.setsort("titulacion_cuenta A")
	dw_1.sort()
	if (cbx_2.checked=TRUE) then
      dw_1.setsort("carreras_carrera A, titulacion_cuenta A")
		dw_1.sort()
	end if	
	
end if

if (rb_3.checked=TRUE) then
   dw_1.setsort("titulacion_fecha_examen A")
	dw_1.sort()
	if (cbx_2.checked=TRUE) then
      dw_1.setsort("carreras_carrera A, titulacion_fecha_examen A")
		dw_1.sort()
	end if	
end if

/*Se actualiza el scroll bar a la posicion UNO */
vsb_dw_certificado. event moved(1)
vsb_dw_certificado.position=1
end event

event constructor;TabOrder = 0
end event

type cbx_1 from checkbox within tabpage_general
event clicked pbm_bnclicked
event constructor pbm_constructor
int X=731
int Y=368
int Width=69
int Height=80
BorderStyle BorderStyle=StyleLowered!
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/*Se verifica si son todas las carreras o una en especial, y se manda a carrera */
If (this.checked = TRUE) then
	carrerax=0
	dw_2.visible =FALSE
	vsb_dw_certificado2.visible=FALSE
	
else
	dw_2.visible =TRUE
	vsb_dw_certificado2.visible=TRUE
	carrerax=dw_2.object.cve_carrera[dw_2.getrow()]
end if	


end event

event constructor;TabOrder = 0
carrerax=0

end event

type cbx_2 from checkbox within tabpage_general
int X=1730
int Y=144
int Width=709
int Height=77
string Text="Agrupación por Carrera "
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type st_1 from statictext within tabpage_general
int X=2926
int Y=67
int Width=479
int Height=77
boolean Enabled=false
boolean Border=true
BorderStyle BorderStyle=StyleLowered!
string Text="Total : 0"
Alignment Alignment=Center!
boolean FocusRectangle=false
long BackColor=15793151
int TextSize=-9
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type gb_3 from groupbox within tabpage_general
int X=48
int Y=67
int Width=421
int Height=189
int TabOrder=5
string Text="  Fecha Inicial "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_1 from groupbox within tabpage_general
int X=1496
int Y=64
int Width=1039
int Height=288
int TabOrder=5
string Text=" Opciones de Ordenamiento "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_4 from groupbox within tabpage_general
int X=516
int Y=67
int Width=421
int Height=189
int TabOrder=4
string Text="  Fecha Final "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_6 from groupbox within tabpage_general
int X=2970
int Y=339
int Width=391
int Height=237
int TabOrder=7
string Text="Movimiento"
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_8 from groupbox within tabpage_general
int X=2564
int Y=61
int Width=333
int Height=163
int TabOrder=4
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type vsb_dw_certificado2 from vscrollbar within tabpage_general
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=2564
int Y=477
int Width=154
int Height=106
boolean Enabled=false
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_2.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_2.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */

dw_2.ScrollToRow(scrollpos)

carrerax=dw_2.object.cve_carrera[dw_2.getrow()]
end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_2.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type dw_2 from datawindow within tabpage_general
event constructor pbm_constructor
event dberror pbm_dwndberror
event retrieveend pbm_dwnretrieveend
event rowfocuschanged pbm_dwnrowchange
event type integer carga ( string cuenta,  string carrera )
event borra_renglon ( )
event actualiza ( )
event nuevo ( )
event botonazo pbm_dwnkey
int X=102
int Y=445
int Width=2692
int Height=157
int TabOrder=4
string DataObject="dw_titulacion_carrera_arch"
boolean Border=false
end type

event constructor;/*En cuanto se construya el dw_1...*/
settransobject(gtr_sce)

retrieve()
visible=FALSE
vsb_dw_certificado2.visible=FALSE
TabOrder = 0
end event

event dberror;return -1
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/

//int Cont

/*Verifica si se bajo más de un dato*/
if rowcount>1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	vsb_dw_certificado2.visible=TRUE
else
	vsb_dw_certificado2.visible=FALSE
end if

//for Cont=1 to Rowcount() 
//	setitem(Cont,"digito",obten_digito(long(getitemnumber(Cont,"titulacion_cuenta"))))
//next


	

end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificado2.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificado2.position=currentrow

end if


end event

event borra_renglon;/*Cuando se activa el evonto borra_renglon...*/

/*Pregunta para verificar que realmente se desea borrar el renglón*/
int respuesta
respuesta = messagebox("Atención","Esta seguro de querer borrar el campo actual.",StopSign!,YesNo!,2)

if respuesta = 1 then
	/*Si realmente se desea borrar, borra el renglón actual y verifica que se haya logrado*/
	if deleterow(getrow())	= 1 then
		/*Si se borro, llama a actualiza*/
		event actualiza()

	else
		/*De lo contrario avisa que no se pudo borrar el renglón*/
		messagebox("Información","No se han guardado los cambios")	
	end if
elseif respuesta = 2 then
	/*Si no se quiere borrar el renglón, desecha los cambios hechos.*/
	rollback using gtr_sce;
end if

end event

event actualiza;/*Cuando se dispara el evento actualiza...*/
/*Si es asi, acepta el texto de la última columna editada*/
AcceptText()
/*Ve si existen cambios en el DataWindow que no se hayan guardado*/
if dw_2.ModifiedCount()+dw_2.DeletedCount() > 0 Then

	/*Pregunta si se desean guardar los cambios hechos*/
	int respuesta
	respuesta = messagebox("Atención","Desea actualizar los cambios:",StopSign!,YesNo!,2)

	if respuesta = 1 &
		then
			
			/*Checa que los renglones cumplan con las reglas de validación*/
			if update(true) = 1 then		
				/*Si es asi, guardalo en la tabla y avisa.*/
				commit using gtr_sce;
				messagebox("Información","Se han guardado los cambios")			
			else
				/*De lo contrario, desecha los cambios (todos) y avisa*/
				rollback using gtr_sce;
				messagebox("Información",&
				"Algunos datos están incorrectos, favor de corregirlos. O bien trata de dar de Alta a una persona ya actualizada")
			end if
	else
		/*De lo contrario, solo avisa que no se guardó nada.*/
		messagebox("Información","No se han guardado los cambios")
	end if	
end if	
end event

event nuevo;/*Cuando se activa el evento nuevo...*/
long VarX

enabled=true
visible=true
/*Pon el foco dentro del DataWindow*/
SetFocus()


/*Inserta un nuevo renglón al final del DataWindow y haz un Scroll hacia él*/
scrolltorow(insertrow(0))




end event

event botonazo;/* Evento que controla el TAB */
IF keyflags  = 0 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=10 then
			setcolumn(1)
			SetFocus()
			return -1
		end if
	END IF
END IF

IF keyflags  = 0 THEN
	IF key = KeyEnter! THEN
		if update(true) = 1 then
			setcolumn(2)
			SetFocus()
		else
			return -1
		end if
	END IF
END IF

IF keyflags  = 1 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=1 then
			setcolumn(10)
			SetFocus()
			return -1
		end if	
	END IF
END IF

end event

type gb_2 from groupbox within tabpage_general
int X=88
int Y=368
int Width=2739
int Height=256
int TabOrder=8
string Text="  Todas las Carreras          "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_7 from groupbox within tabpage_general
int X=2929
int Y=144
int Width=475
int Height=445
int TabOrder=3
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_5 from groupbox within tabpage_general
int X=7
int Width=3478
int Height=666
int TabOrder=5
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type dw_1 from datawindow within tabpage_general
event constructor pbm_constructor
event dberror pbm_dwndberror
event retrieveend pbm_dwnretrieveend
event rowfocuschanged pbm_dwnrowchange
event type integer carga ( string cuenta,  string carrera )
event borra_renglon ( )
event actualiza ( )
event nuevo ( )
event botonazo pbm_dwnkey
int Y=669
int Width=3515
int Height=1069
int TabOrder=5
string DataObject="dw_titulacion_rep_arch"
end type

event constructor;/*En cuanto se construya el dw_1...*/
settransobject(gtr_sce)
//m_titulacion2.dw = this
TabOrder = 0

end event

event dberror;return -1
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/

string Cont

/*Verifica si se bajo más de un dato*/
if rowcount>=1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	Cont =string(rowcount)
	vsb_dw_certificado.visible=TRUE
	st_1.text='Total : '+Cont
else
	vsb_dw_certificado.visible=FALSE
	st_1.text='Total : '+Cont
end if

	

end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificado.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificado.position=currentrow

end if


end event

event borra_renglon;/*Cuando se activa el evonto borra_renglon...*/

/*Pregunta para verificar que realmente se desea borrar el renglón*/
int respuesta
respuesta = messagebox("Atención","Esta seguro de querer borrar el campo actual.",StopSign!,YesNo!,2)

if respuesta = 1 then
	/*Si realmente se desea borrar, borra el renglón actual y verifica que se haya logrado*/
	if deleterow(getrow())	= 1 then
		/*Si se borro, llama a actualiza*/
		event actualiza()

	else
		/*De lo contrario avisa que no se pudo borrar el renglón*/
		messagebox("Información","No se han guardado los cambios")	
	end if
elseif respuesta = 2 then
	/*Si no se quiere borrar el renglón, desecha los cambios hechos.*/
	rollback using gtr_sce;
end if

end event

event actualiza;/*Cuando se dispara el evento actualiza...*/
/*Si es asi, acepta el texto de la última columna editada*/
AcceptText()
/*Ve si existen cambios en el DataWindow que no se hayan guardado*/
if dw_1.ModifiedCount()+dw_1.DeletedCount() > 0 Then

	/*Pregunta si se desean guardar los cambios hechos*/
	int respuesta
	respuesta = messagebox("Atención","Desea actualizar los cambios:",StopSign!,YesNo!,2)

	if respuesta = 1 &
		then
			
			/*Checa que los renglones cumplan con las reglas de validación*/
			if update(true) = 1 then		
				/*Si es asi, guardalo en la tabla y avisa.*/
				commit using gtr_sce;
				messagebox("Información","Se han guardado los cambios")			
			else
				/*De lo contrario, desecha los cambios (todos) y avisa*/
				rollback using gtr_sce;
				messagebox("Información",&
				"Algunos datos están incorrectos, favor de corregirlos. O bien trata de dar de Alta a una persona ya actualizada")
			end if
	else
		/*De lo contrario, solo avisa que no se guardó nada.*/
		messagebox("Información","No se han guardado los cambios")
	end if	
end if	
end event

event nuevo;/*Cuando se activa el evento nuevo...*/
long VarX

enabled=true
visible=true
/*Pon el foco dentro del DataWindow*/
SetFocus()


/*Inserta un nuevo renglón al final del DataWindow y haz un Scroll hacia él*/
scrolltorow(insertrow(0))




end event

event botonazo;/* Evento que controla el TAB */
IF keyflags  = 0 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=10 then
			setcolumn(1)
			SetFocus()
			return -1
		end if
	END IF
END IF

IF keyflags  = 0 THEN
	IF key = KeyEnter! THEN
		if update(true) = 1 then
			setcolumn(2)
			SetFocus()
		else
			return -1
		end if
	END IF
END IF

IF keyflags  = 1 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=1 then
			setcolumn(10)
			SetFocus()
			return -1
		end if	
	END IF
END IF

end event

type tabpage_individual from userobject within tab_1
int X=113
int Y=13
int Width=3544
int Height=1760
long BackColor=16777215
string Text="Individual"
long TabBackColor=12639424
long TabTextColor=33554432
long PictureMaskColor=553648127
string PictureName="Move!"
uo_nivel_2 uo_nivel_2
lb_1 lb_1
dw_2x dw_2x
cb_5x cb_5x
rb_3x rb_3x
rb_2x rb_2x
rb_1x rb_1x
cbx_2x cbx_2x
st_1x st_1x
em_1x em_1x
cb_3x cb_3x
gb_8x gb_8x
gb_7x gb_7x
gb_2x gb_2x
cb_4x cb_4x
cb_1x cb_1x
gb_3x gb_3x
gb_4x gb_4x
cb_2x cb_2x
gb_5x gb_5x
gb_6x gb_6x
vsb_dw_certificadox vsb_dw_certificadox
gb_1x gb_1x
lb_2 lb_2
dw_1x dw_1x
end type

on tabpage_individual.create
this.uo_nivel_2=create uo_nivel_2
this.lb_1=create lb_1
this.dw_2x=create dw_2x
this.cb_5x=create cb_5x
this.rb_3x=create rb_3x
this.rb_2x=create rb_2x
this.rb_1x=create rb_1x
this.cbx_2x=create cbx_2x
this.st_1x=create st_1x
this.em_1x=create em_1x
this.cb_3x=create cb_3x
this.gb_8x=create gb_8x
this.gb_7x=create gb_7x
this.gb_2x=create gb_2x
this.cb_4x=create cb_4x
this.cb_1x=create cb_1x
this.gb_3x=create gb_3x
this.gb_4x=create gb_4x
this.cb_2x=create cb_2x
this.gb_5x=create gb_5x
this.gb_6x=create gb_6x
this.vsb_dw_certificadox=create vsb_dw_certificadox
this.gb_1x=create gb_1x
this.lb_2=create lb_2
this.dw_1x=create dw_1x
this.Control[]={this.uo_nivel_2,&
this.lb_1,&
this.dw_2x,&
this.cb_5x,&
this.rb_3x,&
this.rb_2x,&
this.rb_1x,&
this.cbx_2x,&
this.st_1x,&
this.em_1x,&
this.cb_3x,&
this.gb_8x,&
this.gb_7x,&
this.gb_2x,&
this.cb_4x,&
this.cb_1x,&
this.gb_3x,&
this.gb_4x,&
this.cb_2x,&
this.gb_5x,&
this.gb_6x,&
this.vsb_dw_certificadox,&
this.gb_1x,&
this.lb_2,&
this.dw_1x}
end on

on tabpage_individual.destroy
destroy(this.uo_nivel_2)
destroy(this.lb_1)
destroy(this.dw_2x)
destroy(this.cb_5x)
destroy(this.rb_3x)
destroy(this.rb_2x)
destroy(this.rb_1x)
destroy(this.cbx_2x)
destroy(this.st_1x)
destroy(this.em_1x)
destroy(this.cb_3x)
destroy(this.gb_8x)
destroy(this.gb_7x)
destroy(this.gb_2x)
destroy(this.cb_4x)
destroy(this.cb_1x)
destroy(this.gb_3x)
destroy(this.gb_4x)
destroy(this.cb_2x)
destroy(this.gb_5x)
destroy(this.gb_6x)
destroy(this.vsb_dw_certificadox)
destroy(this.gb_1x)
destroy(this.lb_2)
destroy(this.dw_1x)
end on

type uo_nivel_2 from uo_mostrar_grado within tabpage_individual
int X=1167
int Y=64
int TabOrder=14
boolean Border=false
BorderStyle BorderStyle=StyleBox!
end type

on uo_nivel_2.destroy
call uo_mostrar_grado::destroy
end on

type lb_1 from listbox within tabpage_individual
event constructor pbm_constructor
event invierte_seleccion ( )
event selecciona_todo ( )
int X=1744
int Y=125
int Width=545
int Height=371
int TabOrder=5
BorderStyle BorderStyle=StyleLowered!
boolean VScrollBar=true
boolean MultiSelect=true
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

event invierte_seleccion;integer 	li_totalitems
long		ll_item

//Only a valid operation when MuliSelect is set to True.
If this.MultiSelect Then
	li_totalitems = this.TotalItems()
	//Loop through all items - Inverting each item
	For ll_item = 1 to li_totalitems
		this.SetState(ll_item, (Not this.State(ll_item)=1) )
	Next
//	//Number of selected items
//	Return this.TotalSelected()
End If

//Not a valid operation
//Return 0
end event

event selecciona_todo;integer 	li_totalitems
long		ll_item

//Only a valid operation when MuliSelect is set to True.
If this.MultiSelect Then
	li_totalitems = this.TotalItems()
	//Loop through all items
	For ll_item = 1 to li_totalitems
		this.SetState(ll_item, True)
	Next
	//Number of selected items
//	Return li_totalitems
End If

//Not a valid operation
//Return 0
end event

type dw_2x from datawindow within tabpage_individual
event constructor pbm_constructor
int Y=1779
int Width=3379
int Height=301
int TabOrder=4
string DataObject="dw_tit_cuentax_arch"
boolean LiveScroll=true
end type

event constructor;settransobject(gtr_sce)
//m_titulacion2.dw2 = this
TabOrder = 0
end event

type cb_5x from commandbutton within tabpage_individual
event clicked pbm_bnclicked
int X=1287
int Y=419
int Width=271
int Height=128
int TabOrder=5
boolean BringToTop=true
string Text="Ordenar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se verifica que opcion de Ordenamiento se requiere por medio de los checks*/

if (rb_1x.checked=TRUE) then
   dw_1x.setsort("alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A, carreras_carrera A")
	dw_1x.sort()
   if (cbx_2x.checked=TRUE) then
      dw_1x.setsort("carreras_carrera A, alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A")
		dw_1x.sort()
	end if	
end if

if (rb_2x.checked=TRUE) then
   dw_1x.setsort("titulacion_cuenta A")
	dw_1x.sort()
	if (cbx_2x.checked=TRUE) then
      dw_1x.setsort("carreras_carrera A, titulacion_cuenta A")
		dw_1x.sort()
	end if	
	
end if

if (rb_3x.checked=TRUE) then
   dw_1x.setsort("titulacion_fecha_examen A")
	dw_1x.sort()
	if (cbx_2x.checked=TRUE) then
      dw_1x.setsort("carreras_carrera A, titulacion_fecha_examen A")
		dw_1x.sort()
	end if	
end if

/*Se actualiza el scroll bar a la posicion UNO */
vsb_dw_certificadox. event moved(1)
vsb_dw_certificadox.position=1
end event

event constructor;TabOrder = 0
end event

type rb_3x from radiobutton within tabpage_individual
int X=794
int Y=467
int Width=252
int Height=77
boolean BringToTop=true
string Text="Fecha"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type rb_2x from radiobutton within tabpage_individual
int X=472
int Y=474
int Width=282
int Height=67
boolean BringToTop=true
string Text="Cuenta"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type rb_1x from radiobutton within tabpage_individual
int X=88
int Y=474
int Width=344
int Height=77
boolean BringToTop=true
string Text="Alfabetico"
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type cbx_2x from checkbox within tabpage_individual
int X=238
int Y=384
int Width=709
int Height=77
boolean BringToTop=true
string Text="Agrupación por Carrera "
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;TabOrder = 0
end event

type st_1x from statictext within tabpage_individual
int X=2831
int Y=48
int Width=479
int Height=77
boolean Enabled=false
boolean Border=true
BorderStyle BorderStyle=StyleLowered!
string Text="Total : 0"
Alignment Alignment=Center!
boolean FocusRectangle=false
long BackColor=15793151
int TextSize=-9
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type em_1x from editmask within tabpage_individual
event modified pbm_enmodified
int X=168
int Y=128
int Width=475
int Height=83
int TabOrder=2
BorderStyle BorderStyle=StyleLowered!
string Mask="###xxxxxx"
MaskDataType MaskDataType=StringMask!
string DisplayData="Ä"
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event modified;string Cuenta
string Digito_X
string Digito
/* Si se detecta un ENTER se verifica que haya escrito algo y se verifica el numero de cuenta 
en el evento clicked de cd_1x*/
if keydown(keyenter!) then	
	Cuenta=this.text
	if (Cuenta <> '') then
   	  cb_1x.triggerevent("clicked")
	end if	
end if

end event

event constructor;TabOrder = 1
end event

type cb_3x from commandbutton within tabpage_individual
event clicked pbm_bnclicked
int X=2904
int Y=160
int Width=347
int Height=90
int TabOrder=3
string Text="Cargar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se le pasa el arreglo al datawindow*/
int Total
int contador
string Textito
long Number[]

string ls_nivel
SetNull(ls_nivel)

if uo_nivel_2.rb_licenciatura.Checked then
	ls_nivel = "L"
elseif uo_nivel_2.rb_posgrado.Checked then
	ls_nivel = "P"
elseif uo_nivel_2.rb_todos.Checked then
	ls_nivel = "X"
end if

Total=lb_2.totalitems()


if Total > 0 then
   contador=1
	FOR contador=1 TO Total
		Textito=lb_2.text(contador)
		Number[contador]=long(Textito)
   	
	NEXT
	dw_1x.retrieve(Number, ls_nivel)
	dw_2x.retrieve(Number, ls_nivel)
	cb_5x.triggerevent("clicked") 
end if
end event

event constructor;TabOrder = 3
end event

type gb_8x from groupbox within tabpage_individual
int X=1258
int Y=365
int Width=329
int Height=208
int TabOrder=6
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_7x from groupbox within tabpage_individual
int X=51
int Y=317
int Width=1079
int Height=253
int TabOrder=5
string Text=" Opciones de Ordenamiento "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_2x from groupbox within tabpage_individual
int X=55
int Y=58
int Width=695
int Height=179
int TabOrder=3
string Text=" Núm. de Cuenta "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type cb_4x from commandbutton within tabpage_individual
event clicked pbm_bnclicked
int X=2355
int Y=387
int Width=278
int Height=109
int TabOrder=3
boolean BringToTop=true
string Text="Limpiar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se limpia la lista de alumnos y el datawindow*/
int Total
long Number[]

Total=lb_1.totalitems()
DO UNTIL Total=0
		lb_1.DeleteItem(1)
      lb_2.DeleteItem(1)
		Total=lb_1.totalitems()
LOOP
Number[1]=0
dw_1x.retrieve(Number)
end event

event constructor;TabOrder = 0
end event

type cb_1x from commandbutton within tabpage_individual
event clicked pbm_bnclicked
event type integer verifica ( )
event type integer verifica_2 ( string cuenta )
int X=816
int Y=109
int Width=278
int Height=109
int TabOrder=2
boolean BringToTop=true
string Text="Agregar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se verifica que exista el alumno y que no este en la lista y que su digito verificador este
correcto */
string Cuenta
	Cuenta=em_1x.text
	if (Cuenta <> '') then
		if this. EVENT verifica() = 1 then
		else
			em_1x.SelectText(1, Len(em_1x.Text))
			em_1x.setfocus()
		end if	  
end if
end event

event verifica;/* Se verifica que el alumno exista y que el digito verificador corresponda */
string Digito_X
string Digito
string Cuenta
long Cuenta_A
long Cuenta_B

Cuenta=upper(em_1x.text)
Digito_X=mid(Cuenta,len(Cuenta),len(Cuenta))
Cuenta=mid(Cuenta,1,len(Cuenta)-1)
Digito=obten_digito ( long (Cuenta) )
Cuenta_A=long(Cuenta)

SELECT alumnos.cuenta  
    INTO :Cuenta_B  
	 FROM alumnos  
	 WHERE alumnos.cuenta = :Cuenta_A using gtr_sce;
	 if gtr_sce.sqlcode = 100 then
			messagebox("Atención","El alumno con clave "+string(cuenta)+" no existe.")
		   /* Alumno no existe */
			return 0
	 else		
		
		if Digito=Digito_X then
	      if this. EVENT verifica_2(Cuenta) = 1 then
			   lb_1.additem (Cuenta+" - "+Digito_X)
            lb_2.additem (Cuenta)
			   em_1x.text=''
		      return 1 /* Todo esta bien */
	      else
   			/* Ya esta en la lista */
	   		return 0
		   end if	
	 
	   else
	      /* Digito Verificador Erroneo */
         messagebox("Atención","El digito verificador es ERRONEO, favor de revisarlo")
      	return 0
      end if

end if

		
		
		
		










end event

event verifica_2;/* Se verifica que no se enceuntre en la lista */
int Total
int contador
string Textito
int Bandera

Bandera=0
Total=lb_2.totalitems()

if Total > 0 then
   contador=1
	FOR contador=1 TO Total
		Textito=lb_2.text(contador)
	   if Cuenta=Textito then
			Bandera=1  /*Si existe */
		end if	
	NEXT

end if

if Bandera = 1 then
	messagebox("Atención","El número de cuenta que desea introducir ~r~ "+&
	                      "        YA SE ENCUENTRA LA LISTA")
	return 0 /* Si existe */
else
	return 1 /* No existe, todo esta bien */
end if
end event

event constructor;TabOrder = 2
end event

type gb_3x from groupbox within tabpage_individual
int X=783
int Y=58
int Width=347
int Height=179
int TabOrder=4
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_4x from groupbox within tabpage_individual
int X=1715
int Y=58
int Width=973
int Height=474
int TabOrder=3
string Text=" Lista  "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type cb_2x from commandbutton within tabpage_individual
event clicked pbm_bnclicked
int X=2355
int Y=122
int Width=278
int Height=109
int TabOrder=2
boolean BringToTop=true
string Text="Eliminar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Cuando se selecciona un numero de cuenta de la lista se borra */
integer li_Index

li_Index = lb_1.SelectedIndex( )
lb_1.DeleteItem(li_Index)
lb_2.DeleteItem(li_Index)


end event

event constructor;TabOrder = 0
end event

type gb_5x from groupbox within tabpage_individual
int X=2864
int Y=259
int Width=439
int Height=253
int TabOrder=4
string Text=" Movimiento"
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_6x from groupbox within tabpage_individual
int X=2790
int Y=106
int Width=563
int Height=426
int TabOrder=4
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type vsb_dw_certificadox from vscrollbar within tabpage_individual
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=2970
int Y=330
int Width=205
int Height=163
boolean Enabled=false
boolean BringToTop=true
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1x.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_1x.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */
dw_1x.ScrollToRow(scrollpos)

if dw_1x.Rowcount()=0 then
	st_1x.text='Actual : 0 / 0'	
else
   st_1x.text='Actual : '+string(scrollpos)+' / '+string(dw_1x.RowCount())	
end if

end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1x.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type gb_1x from groupbox within tabpage_individual
int X=4
int Width=3478
int Height=621
int TabOrder=4
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type lb_2 from listbox within tabpage_individual
int X=1247
int Y=93
int Width=289
int Height=74
int TabOrder=2
boolean Enabled=false
BorderStyle BorderStyle=StyleLowered!
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type dw_1x from datawindow within tabpage_individual
event constructor pbm_constructor
int Y=621
int Width=3463
int Height=1088
int TabOrder=4
string DataObject="dw_titulacion_repx_arch"
end type

event constructor;settransobject(gtr_sce)
TabOrder = 0
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/


int li_Index
int Total
int Total_Renglon
int Contador


string Cont
Cont = '0'
/*Verifica si se bajo más de un dato*/
if rowcount >= 1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	Cont =string(rowcount)
	vsb_dw_certificadox.visible=TRUE
	st_1x.text='Total : '+Cont
   
	Total=lb_2.totalitems()
   Total_Renglon=rowcount()
   
	lb_1.EVENT selecciona_todo()
   lb_1.EVENT invierte_seleccion()
	
		 FOR Contador=1 to Total_Renglon		   
	     li_Index = lb_1.SelectItem(string(object.titulacion_cuenta[Contador]), 1)
		  lb_1.SetState(li_Index, TRUE)		  
       NEXT
		 
 	/* Selecciona a los numero de cuenta que no se encontraron */	 
   lb_1.EVENT invierte_seleccion()

	
else
	vsb_dw_certificadox.visible=FALSE
	st_1x.text='Total : '+Cont
	lb_1.EVENT selecciona_todo()
end if



	
end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificadox.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificadox.position=currentrow

end if

end event

type tabpage_opcion from userobject within tab_1
event create ( )
event destroy ( )
int X=113
int Y=13
int Width=3544
int Height=1760
long BackColor=0
string Text="X Opción"
long TabBackColor=32567536
long TabTextColor=33554432
long PictureMaskColor=553648127
string PictureName="Count!"
uo_nivel_3 uo_nivel_3
dw_3w dw_3w
rb_1w rb_1w
rb_2w rb_2w
rb_3w rb_3w
vsb_dw_certificadow vsb_dw_certificadow
cb_1w cb_1w
em_2w em_2w
em_1w em_1w
cb_3w cb_3w
cbx_1w cbx_1w
cbx_2w cbx_2w
st_1w st_1w
gb_3w gb_3w
gb_4w gb_4w
gb_6w gb_6w
gb_8w gb_8w
gb_1w gb_1w
vsb_dw_certificado2w vsb_dw_certificado2w
dw_2w dw_2w
gb_2w gb_2w
vsb_dw_certificado3 vsb_dw_certificado3
gb_9w gb_9w
gb_7w gb_7w
gb_5w gb_5w
dw_4w dw_4w
dw_1w dw_1w
end type

on tabpage_opcion.create
this.uo_nivel_3=create uo_nivel_3
this.dw_3w=create dw_3w
this.rb_1w=create rb_1w
this.rb_2w=create rb_2w
this.rb_3w=create rb_3w
this.vsb_dw_certificadow=create vsb_dw_certificadow
this.cb_1w=create cb_1w
this.em_2w=create em_2w
this.em_1w=create em_1w
this.cb_3w=create cb_3w
this.cbx_1w=create cbx_1w
this.cbx_2w=create cbx_2w
this.st_1w=create st_1w
this.gb_3w=create gb_3w
this.gb_4w=create gb_4w
this.gb_6w=create gb_6w
this.gb_8w=create gb_8w
this.gb_1w=create gb_1w
this.vsb_dw_certificado2w=create vsb_dw_certificado2w
this.dw_2w=create dw_2w
this.gb_2w=create gb_2w
this.vsb_dw_certificado3=create vsb_dw_certificado3
this.gb_9w=create gb_9w
this.gb_7w=create gb_7w
this.gb_5w=create gb_5w
this.dw_4w=create dw_4w
this.dw_1w=create dw_1w
this.Control[]={this.uo_nivel_3,&
this.dw_3w,&
this.rb_1w,&
this.rb_2w,&
this.rb_3w,&
this.vsb_dw_certificadow,&
this.cb_1w,&
this.em_2w,&
this.em_1w,&
this.cb_3w,&
this.cbx_1w,&
this.cbx_2w,&
this.st_1w,&
this.gb_3w,&
this.gb_4w,&
this.gb_6w,&
this.gb_8w,&
this.gb_1w,&
this.vsb_dw_certificado2w,&
this.dw_2w,&
this.gb_2w,&
this.vsb_dw_certificado3,&
this.gb_9w,&
this.gb_7w,&
this.gb_5w,&
this.dw_4w,&
this.dw_1w}
end on

on tabpage_opcion.destroy
destroy(this.uo_nivel_3)
destroy(this.dw_3w)
destroy(this.rb_1w)
destroy(this.rb_2w)
destroy(this.rb_3w)
destroy(this.vsb_dw_certificadow)
destroy(this.cb_1w)
destroy(this.em_2w)
destroy(this.em_1w)
destroy(this.cb_3w)
destroy(this.cbx_1w)
destroy(this.cbx_2w)
destroy(this.st_1w)
destroy(this.gb_3w)
destroy(this.gb_4w)
destroy(this.gb_6w)
destroy(this.gb_8w)
destroy(this.gb_1w)
destroy(this.vsb_dw_certificado2w)
destroy(this.dw_2w)
destroy(this.gb_2w)
destroy(this.vsb_dw_certificado3)
destroy(this.gb_9w)
destroy(this.gb_7w)
destroy(this.gb_5w)
destroy(this.dw_4w)
destroy(this.dw_1w)
end on

type uo_nivel_3 from uo_mostrar_grado within tabpage_opcion
int X=2355
int Y=58
int TabOrder=14
boolean Border=false
BorderStyle BorderStyle=StyleBox!
end type

on uo_nivel_3.destroy
call uo_mostrar_grado::destroy
end on

type dw_3w from datawindow within tabpage_opcion
event constructor pbm_constructor
int Y=2058
int Width=3493
int Height=362
int TabOrder=6
string DataObject="dw_tit_cuenta11_arch"
boolean LiveScroll=true
end type

event constructor;settransobject(gtr_sce)
//m_titulacion2.dw2 = this
TabOrder = 0
end event

type rb_1w from radiobutton within tabpage_opcion
int X=1671
int Y=224
int Width=450
int Height=67
boolean BringToTop=true
string Text="Alfabetico"
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type rb_2w from radiobutton within tabpage_opcion
int X=1671
int Y=304
int Width=450
int Height=61
boolean BringToTop=true
string Text="Cuenta"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type rb_3w from radiobutton within tabpage_opcion
int X=1671
int Y=378
int Width=450
int Height=64
boolean BringToTop=true
string Text="Fecha"
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type vsb_dw_certificadow from vscrollbar within tabpage_opcion
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=3054
int Y=477
int Width=201
int Height=157
boolean Enabled=false
boolean BringToTop=true
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_1w.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */
dw_1w.ScrollToRow(scrollpos)

if dw_1w.Rowcount()=0 then
	st_1w.text='Actual : 0 / 0'	
else
   st_1w.text='Actual : '+string(scrollpos)+' / '+string(dw_1w.RowCount())	
end if

end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_1w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type cb_1w from commandbutton within tabpage_opcion
event clicked pbm_bnclicked
int X=3021
int Y=282
int Width=263
int Height=109
int TabOrder=5
boolean BringToTop=true
string Text="Cargar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;string ls_nivel
SetNull(ls_nivel)

if uo_nivel_3.rb_licenciatura.Checked then
	ls_nivel = "L"
elseif uo_nivel_3.rb_posgrado.Checked then
	ls_nivel = "P"
elseif uo_nivel_3.rb_todos.Checked then
	ls_nivel = "X"
end if


/*Se validan las fechas, y si son validas se mandan al datawindow */
if isdate(em_1w.text) and isdate(em_2w.text) then
	if date(em_2w.text)>=date(em_1w.text) then
			if (carrera2 = 999) then
				carrera2=0
			end if	
			dw_1w.retrieve(date(em_1w.text),date(em_2w.text),carrera2,opcion, ls_nivel)
			dw_3w.retrieve(date(em_1w.text),date(em_2w.text),carrera2,opcion, ls_nivel)
/* Se ordenan al terminar de traer los datos */
			cb_3w.triggerevent("clicked") 
	else
		messagebox(" Error ","Las fechas poseen un formato invalido, posiblemente la fecha inicial sea mayor a la fecha final",StopSign!)
	end if	
else	
     messagebox("Error","Las fechas poseen un formato invalido, favor de revisar",StopSign!)
end if


end event

event constructor;TabOrder = 3
end event

type em_2w from editmask within tabpage_opcion
int X=644
int Y=138
int Width=362
int Height=83
int TabOrder=4
boolean BringToTop=true
Alignment Alignment=Center!
BorderStyle BorderStyle=StyleLowered!
string Mask="dd/mm/yyyy"
MaskDataType MaskDataType=DateMask!
string DisplayData="Ä"
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 2
end event

type em_1w from editmask within tabpage_opcion
event constructor pbm_constructor
int X=121
int Y=138
int Width=362
int Height=83
int TabOrder=3
boolean BringToTop=true
Alignment Alignment=Center!
BorderStyle BorderStyle=StyleLowered!
string Mask="dd/mm/yyyy"
MaskDataType MaskDataType=DateMask!
string DisplayData=""
long BackColor=15793151
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 1
end event

type cb_3w from commandbutton within tabpage_opcion
event clicked pbm_bnclicked
int X=1156
int Y=112
int Width=274
int Height=90
int TabOrder=3
boolean BringToTop=true
string Text="Ordenar"
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/* Se verifica que opcion de Ordenamiento se requiere por medio de los checks*/
if (rb_1w.checked=TRUE) then
   dw_1w.setsort("alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A, carreras_carrera A")
	dw_1w.sort()
   if (cbx_2w.checked=TRUE) then
      dw_1w.setsort("carreras_carrera A, alumnos_apaterno A, alumnos_amaterno A, alumnos_nombre A")
		dw_1w.sort()
	end if	
end if

if (rb_2w.checked=TRUE) then
   dw_1w.setsort("titulacion_cuenta A")
	dw_1w.sort()
	if (cbx_2w.checked=TRUE) then
      dw_1w.setsort("carreras_carrera A, titulacion_cuenta A")
		dw_1w.sort()
	end if	
	
end if

if (rb_3w.checked=TRUE) then
   dw_1w.setsort("titulacion_fecha_examen A")
	dw_1w.sort()
	if (cbx_2w.checked=TRUE) then
      dw_1w.setsort("carreras_carrera A, titulacion_fecha_examen A")
		dw_1w.sort()
	end if	
end if
/*Se actualiza el scroll bar a la posicion UNO */
vsb_dw_certificadow. event moved(1)
vsb_dw_certificadow.position=1
end event

event constructor;TabOrder = 0
end event

type cbx_1w from checkbox within tabpage_opcion
event clicked pbm_bnclicked
event constructor pbm_constructor
int X=666
int Y=467
int Width=69
int Height=64
boolean BringToTop=true
BorderStyle BorderStyle=StyleLowered!
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event clicked;/*Se verifica si son todas las carreras o una en especial, y se manda a carrera */
If (this.checked = TRUE) then
	carrera2=0
	dw_2w.visible =FALSE
	vsb_dw_certificado2w.visible=FALSE
	
else
	dw_2w.visible =TRUE
	vsb_dw_certificado2w.visible=TRUE
	carrera2=dw_2w.object.cve_carrera[dw_2w.getrow()]
end if	


end event

event constructor;TabOrder = 0
carrera2=0

end event

type cbx_2w from checkbox within tabpage_opcion
int X=1573
int Y=131
int Width=709
int Height=77
boolean BringToTop=true
string Text="Agrupación por Carrera "
boolean Checked=true
boolean LeftText=true
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type st_1w from statictext within tabpage_opcion
int X=2907
int Y=83
int Width=479
int Height=77
boolean Enabled=false
boolean Border=true
BorderStyle BorderStyle=StyleLowered!
string Text="Total : 0"
Alignment Alignment=Center!
boolean FocusRectangle=false
long BackColor=15793151
int TextSize=-9
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

event constructor;TabOrder = 0
end event

type gb_3w from groupbox within tabpage_opcion
int X=69
int Y=61
int Width=461
int Height=176
int TabOrder=6
string Text=" Fecha Inicial"
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_4w from groupbox within tabpage_opcion
int X=592
int Y=61
int Width=461
int Height=176
int TabOrder=5
string Text=" Fecha Final"
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_6w from groupbox within tabpage_opcion
int X=2959
int Y=413
int Width=391
int Height=237
int TabOrder=6
string Text="Movimiento"
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_8w from groupbox within tabpage_opcion
int X=1119
int Y=61
int Width=336
int Height=163
int TabOrder=7
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_1w from groupbox within tabpage_opcion
int X=1518
int Y=61
int Width=808
int Height=403
int TabOrder=6
string Text="Opciones de Ordenamiento "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type vsb_dw_certificado2w from vscrollbar within tabpage_opcion
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=2509
int Y=560
int Width=154
int Height=106
boolean Enabled=false
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_2w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_2w.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */

dw_2w.ScrollToRow(scrollpos)

carrera2=dw_2w.object.cve_carrera[dw_2w.getrow()]
end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_2w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type dw_2w from datawindow within tabpage_opcion
event constructor pbm_constructor
event dberror pbm_dwndberror
event retrieveend pbm_dwnretrieveend
event rowfocuschanged pbm_dwnrowchange
event type integer carga ( string cuenta,  string carrera )
event borra_renglon ( )
event actualiza ( )
event nuevo ( )
event botonazo pbm_dwnkey
int X=37
int Y=528
int Width=2692
int Height=157
int TabOrder=5
string DataObject="dw_titulacion_carrera_arch"
boolean Border=false
end type

event constructor;/*En cuanto se construya el dw_1...*/
settransobject(gtr_sce)

retrieve()
visible=FALSE
vsb_dw_certificado2w.visible=FALSE
TabOrder = 0
end event

event dberror;return -1
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/

//int Cont

/*Verifica si se bajo más de un dato*/
if rowcount>1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	vsb_dw_certificado2w.visible=TRUE
else
	vsb_dw_certificado2w.visible=FALSE
end if

//for Cont=1 to Rowcount() 
//	setitem(Cont,"digito",obten_digito(long(getitemnumber(Cont,"titulacion_cuenta"))))
//next


	

end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificado2w.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificado2w.position=currentrow

end if


end event

event borra_renglon;///*Cuando se activa el evonto borra_renglon...*/
//
///*Pregunta para verificar que realmente se desea borrar el renglón*/
//int respuesta
//respuesta = messagebox("Atención","Esta seguro de querer borrar el campo actual.",StopSign!,YesNo!,2)
//
//if respuesta = 1 then
//	/*Si realmente se desea borrar, borra el renglón actual y verifica que se haya logrado*/
//	if deleterow(getrow())	= 1 then
//		/*Si se borro, llama a actualiza*/
//		event actualiza()
//
//	else
//		/*De lo contrario avisa que no se pudo borrar el renglón*/
//		messagebox("Información","No se han guardado los cambios")	
//	end if
//elseif respuesta = 2 then
//	/*Si no se quiere borrar el renglón, desecha los cambios hechos.*/
//	rollback using gtr_sce;
//end if

end event

event actualiza;///*Cuando se dispara el evento actualiza...*/
///*Si es asi, acepta el texto de la última columna editada*/
//AcceptText()
///*Ve si existen cambios en el DataWindow que no se hayan guardado*/
//if dw_2.ModifiedCount()+dw_2.DeletedCount() > 0 Then
//
//	/*Pregunta si se desean guardar los cambios hechos*/
//	int respuesta
//	respuesta = messagebox("Atención","Desea actualizar los cambios:",StopSign!,YesNo!,2)
//
//	if respuesta = 1 &
//		then
//			
//			/*Checa que los renglones cumplan con las reglas de validación*/
//			if update(true) = 1 then		
//				/*Si es asi, guardalo en la tabla y avisa.*/
//				commit using gtr_sce;
//				messagebox("Información","Se han guardado los cambios")			
//			else
//				/*De lo contrario, desecha los cambios (todos) y avisa*/
//				rollback using gtr_sce;
//				messagebox("Información",&
//				"Algunos datos están incorrectos, favor de corregirlos. O bien trata de dar de Alta a una persona ya actualizada")
//			end if
//	else
//		/*De lo contrario, solo avisa que no se guardó nada.*/
//		messagebox("Información","No se han guardado los cambios")
//	end if	
//end if	
end event

event nuevo;/*Cuando se activa el evento nuevo...*/
long VarX

enabled=true
visible=true
/*Pon el foco dentro del DataWindow*/
SetFocus()


/*Inserta un nuevo renglón al final del DataWindow y haz un Scroll hacia él*/
scrolltorow(insertrow(0))




end event

event botonazo;/* Evento que controla el TAB */
IF keyflags  = 0 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=10 then
			setcolumn(1)
			SetFocus()
			return -1
		end if
	END IF
END IF

IF keyflags  = 0 THEN
	IF key = KeyEnter! THEN
		if update(true) = 1 then
			setcolumn(2)
			SetFocus()
		else
			return -1
		end if
	END IF
END IF

IF keyflags  = 1 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=1 then
			setcolumn(10)
			SetFocus()
			return -1
		end if	
	END IF
END IF

end event

type gb_2w from groupbox within tabpage_opcion
int X=22
int Y=464
int Width=2739
int Height=256
int TabOrder=5
string Text="  Todas las Carreras          "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type vsb_dw_certificado3 from vscrollbar within tabpage_opcion
event constructor pbm_constructor
event linedown pbm_sbnlinedown
event lineup pbm_sbnlineup
event moved pbm_sbnthumbtrack
event pagedown pbm_sbnpagedown
event pageup pbm_sbnpageup
int X=1280
int Y=285
int Width=150
int Height=106
boolean Enabled=false
boolean BringToTop=true
boolean StdWidth=false
int MinPosition=1
int Position=1
end type

event constructor;visible=FALSE
TabOrder = 0
end event

event linedown;/* En cuanto el usuario oprima la flecha-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_4w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if


end event

event lineup;/* En cuanto el usuario oprima la flecha-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event moved;/* En cuanto se de el evento Moved (usuario moviendo la barra o llamado desde aca adentro)... */

/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
maxposition=dw_4w.RowCount()

/* Haz que el la ventana del DataWindow se mueva al cambiar la posición del ScrollBar */

dw_4w.ScrollToRow(scrollpos)

opcion=dw_4w.object.cve_titulacion[dw_4w.getrow()]
end event

event pagedown;/* En cuanto el usuario oprima la página-abajo del ScrollBar... */

/* Verifica que no esté al final de los renglones del DataWindow */
if position<dw_4w.RowCount() then
	/* Si no lo estoy mueve el scroll bar una posición más */
	position=position+1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

event pageup;/* En cuanto el usuario oprima la página-arriba del ScrollBar... */

/* Verifica que no esté al inicio de los renglones del DataWindow */
if position>1 then
	/* Si no lo estoy mueve el scroll bar una posición menos */
	position=position -1
	/* Genera el evento moved con la nueva posición */
	EVENT moved(position)
end if
end event

type gb_9w from groupbox within tabpage_opcion
int X=40
int Y=243
int Width=1412
int Height=192
int TabOrder=5
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_7w from groupbox within tabpage_opcion
int X=2918
int Y=224
int Width=475
int Height=445
int TabOrder=4
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type gb_5w from groupbox within tabpage_opcion
int X=4
int Width=3478
int Height=739
int TabOrder=6
string Text="Criterios de Busqueda "
BorderStyle BorderStyle=StyleRaised!
long BackColor=12632256
int TextSize=-10
int Weight=400
string FaceName="Arial"
FontFamily FontFamily=Swiss!
FontPitch FontPitch=Variable!
end type

type dw_4w from datawindow within tabpage_opcion
event constructor pbm_constructor
event dberror pbm_dwndberror
event retrieveend pbm_dwnretrieveend
event rowfocuschanged pbm_dwnrowchange
event type integer carga ( string cuenta,  string carrera )
event borra_renglon ( )
event actualiza ( )
event nuevo ( )
event botonazo pbm_dwnkey
int X=59
int Y=285
int Width=1371
int Height=144
int TabOrder=5
boolean BringToTop=true
string DataObject="dw_opc_titulacion_arch"
boolean Border=false
end type

event constructor;/*En cuanto se construya el dw_1...*/
settransobject(gtr_sce)

retrieve()
TabOrder = 0

end event

event dberror;return -1
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/

//int Cont

/*Verifica si se bajo más de un dato*/
if rowcount>1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	vsb_dw_certificado3.visible=TRUE
else
	vsb_dw_certificado3.visible=FALSE
end if

opcion=this.object.cve_titulacion[this.getrow()]
//opcion=this.object.cve_titulacion[getrow()]

	

end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificado3.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificado3.position=currentrow

end if


end event

event botonazo;/* Evento que controla el TAB */
IF keyflags  = 0 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=10 then
			setcolumn(1)
			SetFocus()
			return -1
		end if
	END IF
END IF

IF keyflags  = 0 THEN
	IF key = KeyEnter! THEN
		if update(true) = 1 then
			setcolumn(2)
			SetFocus()
		else
			return -1
		end if
	END IF
END IF

IF keyflags  = 1 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=1 then
			setcolumn(10)
			SetFocus()
			return -1
		end if	
	END IF
END IF

end event

event itemchanged;//Actualiza la opción de titulación al cambiarla

IF dwo.Name = "cve_titulacion" THEN
	opcion=this.object.cve_titulacion[1]
END IF


	

end event

type dw_1w from datawindow within tabpage_opcion
event constructor pbm_constructor
event dberror pbm_dwndberror
event retrieveend pbm_dwnretrieveend
event rowfocuschanged pbm_dwnrowchange
event type integer carga ( string cuenta,  string carrera )
event borra_renglon ( )
event actualiza ( )
event nuevo ( )
event botonazo pbm_dwnkey
int Y=739
int Width=3515
int Height=973
int TabOrder=1
string DataObject="dw_titulacion_rep11_arch"
end type

event constructor;/*En cuanto se construya el dw_1...*/
settransobject(gtr_sce)
//m_titulacion2.dw = this
TabOrder = 0

end event

event dberror;return -1
end event

event retrieveend;/*Cuando dw_1 termine de leer los datos de la tabla...*/

string Cont

/*Verifica si se bajo más de un dato*/
if rowcount>=1 then
	/*Si es así, haz visible el VerticalScrollBar*/
	Cont =string(rowcount)
	vsb_dw_certificadow.visible=TRUE
	st_1w.text='Total : '+Cont
else
	vsb_dw_certificadow.visible=FALSE
	st_1w.text='Total : '+Cont
end if

	

end event

event rowfocuschanged;/* En cuanto el usuario cambie "manualmente" el focus del DataWindow... */

if currentrow>0 then
	accepttext()

	/* Ajusta el tamaño máximo del VerticalScroolBar al número de renglones obtenidos */
	vsb_dw_certificadow.maxposition=RowCount()

	/* Obtén en que renglón está y mueve el ScrollBar en consecuencia */
	vsb_dw_certificadow.position=currentrow

end if


end event

event botonazo;/* Evento que controla el TAB */
IF keyflags  = 0 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=10 then
			setcolumn(1)
			SetFocus()
			return -1
		end if
	END IF
END IF

IF keyflags  = 0 THEN
	IF key = KeyEnter! THEN
		if update(true) = 1 then
			setcolumn(2)
			SetFocus()
		else
			return -1
		end if
	END IF
END IF

IF keyflags  = 1 THEN
	IF key = KeyTab! THEN
		IF getcolumn()=1 then
			setcolumn(10)
			SetFocus()
			return -1
		end if	
	END IF
END IF

end event

